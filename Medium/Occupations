SELECT
MIN(CASE WHEN OCCUPATION = 'Doctor' THEN Name END) as Doctor,
MIN(CASE WHEN OCCUPATION = 'Professor' THEN Name END) as Professor,
MIN(CASE WHEN OCCUPATION = 'Singer' THEN Name END) as Singer,
MIN(CASE WHEN OCCUPATION = 'Actor' THEN Name END) as Actor
FROM 
(     
SELECT OCCUPATION, NAME, RANK() OVER (PARTITION BY OCCUPATION ORDER BY NAME) RNK
FROM OCCUPATIONS
)
GROUP BY RNK
ORDER BY RNK;
