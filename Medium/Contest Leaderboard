SELECT H.HACKER_ID, NAME, SUM(SCORE) TOT_SCORE
FROM 
HACKERS H INNER JOIN
(
SELECT HACKER_ID, CHALLENGE_ID, MAX(SCORE) SCORE
FROM SUBMISSIONS
GROUP BY  HACKER_ID, CHALLENGE_ID
) S ON H.HACKER_ID = S.HACKER_ID
GROUP BY H.HACKER_ID, NAME
HAVING SUM(SCORE) > 0
ORDER BY SUM(SCORE) DESC, HACKER_ID;
